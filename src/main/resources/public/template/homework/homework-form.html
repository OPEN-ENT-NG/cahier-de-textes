<div class="homework-form">
    <div class="row" ng-if="!isInsideSessionForm">
        <div class="six cell twelve-mobile">
            <select ng-change="syncSessionsAndCourses();syncWorkloadWeek();homework.session = undefined;
                            disableFieldSetSubjectAndAudienceHomework(homework.audience,homework.subject);"
                    ng-model="homework.audience"
                    ng-options="audience.name for audience in structure.audiences.all track by audience.id">
                <option value="" disabled selected>[[translate('select.audience')]]</option>
            </select>
            <select ng-change="syncSessionsAndCourses();homework.session = undefined;
                        disableFieldSetSubjectAndAudienceHomework(homework.audience,homework.subject);"
                    ng-model="homework.subject"
                    ng-options="subject.label for subject in subjects.all track by subject.id">
                <option value="" disabled selected>[[translate('select.subject')]]</option>
            </select>
            <span class="text-xl margin-left-md">
                <span style="color: green;" ng-if="homework.isPublished">(<i18n>published</i18n>)</span>
                <span style="color: red;" ng-if="!homework.isPublished">(<i18n>draft</i18n>)</span>
            </span>
        </div>
    </div>
    <fieldset  class="row card padding-md border-widht-fieldset" ng-click="openHomework(homework)"
               ng-disabled="isSelectSubjectAndAudienceHomework">
        <h2 class="remove-margin">
            <span ng-if="!isInsideSessionForm"><i18n>homework</i18n> -</span>
            <span>[[homework.type.label]]</span> -
            <span ng-if="homework.attachedToDate">Pour le [[getDisplayDate(homework.dueDate)]]</span>
            <span ng-if="homework.attachedToParentSession">Pour cette séance</span>
            <span ng-if="homework.attachedToOtherSession && homework.session">Pour la séance [[homework.session.subject.label]]
                [[homework.session.startDisplayDate]] ([[homework.session.startDisplayTime]]-[[homework.session.endDisplayTime]])</span>
            <i class="right-magnet" ng-class="homework.opened ? 'up-open' : 'down-open'"></i>
        </h2>
    </fieldset>
    <div class="row card padding-md" ng-show="homework.opened">
        <!-- Deadline -->
        <div class="row">
            <label class="cell two twelve-mobile">
                <i18n>deadline</i18n>*
            </label>
            <div class="cell twelve-mobile ten">
                <div ng-if="isInsideSessionForm">
                    <label>
                        <input type="radio" ng-model="homework.attachedToParentSession" ng-value="true" ng-click="attachToParentSession()">
                        <i18n>todo.for.this.session</i18n>
                    </label><br/>
                    <label>
                        <input type="radio" ng-model="homework.attachedToParentSession" ng-value="false" ng-click="attachToOtherSession()">
                        <i18n>choose.another.date.or.session</i18n>
                    </label>
                </div>
                <!-- Other Seance or Date -- ng-if="!homework.attachedToParentSession || !isInsideSessionForm"-->
                <div class="row" >
                    <div class="row margin-bottom-md">
                        <label ><!--ng-if="sessionsToAttachTo && sessionsToAttachTo.length > 0"-->
                            <input type="radio"
                                   ng-click="attachToSession()"
                                   ng-checked="homework.attachedToSession"
                                   value="true">
                            <span class="no-style ng-scope"><i18n>session</i18n></span>
                        </label><br>
                        <label  >
                            <input type="radio"
                                   ng-click="attachToDate()"
                                   ng-checked="homework.attachedToDate"
                                   value="false">
                            <span class="no-style ng-scope"><i18n>date</i18n></span>
                        </label>

                    </div>
                    <div class="row margin-bottom-md">
                        <date-picker class="date-picker-sm"  ng-if="homework.attachedToDate"
                                     ng-model="homework.dueDate"  ng-change="syncWorkloadWeek()"></date-picker>
                        <select ng-if="homework.attachedToSession" ng-model="homework.session" ng-change="syncWorkloadWeek()"
                                ng-options="session as (session.subject.label + ' - ' + session.startDisplayDate + ' ' + session.startDisplayTime + '-' + session.endDisplayTime ) for session in sessionsToAttachTo">
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <!-- Workload -->
        <div class="row">
            <label class="cell two twelve-mobile"><i18n>homework.week.workload</i18n></label>
            <div class="cell twelve-mobile ten">
                   <span ng-repeat="workload in homework.workloadWeek.all">
                        <span class="workloadDay" tooltip="[[workload.description]]" ng-class="workload.color">
                    [[workload.shortDayString]] [[workload.numDayString]]</span>
                    </span>
            </div>
        </div>
        <!-- Type -->
        <div class="row form-row">
            <label class="cell two twelve-mobile">
                <i18n>homework.manage.type</i18n>*
            </label>
            <div class="cell twelve-mobile ten">
                <select required ng-model="homework.type" ng-options="homeworkType.label for homeworkType in homeworkTypes.all track by homeworkType.id">
                </select>
            </div>
        </div>
        <!-- Description-->
        <div class="row">
            <editor ng-model="homework.description"></editor>
        </div>

        <div class="row" ng-if="isInsideSessionForm">
            <button class="cancel float-none display-inline-block" type="button" ng-click="cancelCreation()">
                <i18n>utils.cancel</i18n>
            </button>
            <button class="float-none display-inline-block" type="button" ng-click="deleteHomework($index)">
                <i18n>utils.delete</i18n>
            </button>
        </div>
    </div>
</div>
