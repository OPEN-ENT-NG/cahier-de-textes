<div class="session-form">
    <div class="row">
        <div class="six cell twelve-mobile">
            <select required ng-model="session.audience"
                    ng-change="disableFieldSetSubjectAndAudienceSession(session.audience,session.subject)"
                    ng-disabled="session.courseId && session.audience"
                    ng-options="audience.name for audience in structure.audiences.all track by audience.id">
                <option ng-if="structure.audiences.all.length !== 1"  value="" disabled selected>[[translate('select.audience')]]</option>
            </select>
            <select required ng-model="session.subject"
                    ng-change="disableFieldSetSubjectAndAudienceSession(session.audience,session.subject)"
                    ng-disabled="session.courseId && session.subject"
                    ng-options="subject.label for subject in subjects.all track by subject.id">
                <option ng-if="subjects.all.length !== 1" value="" disabled selected>[[translate('select.subject')]]</option>
            </select>
        </div>
    </div>

    <fieldset class="row cursorDefault card remove-margin padding-md border-widht-fieldset"
              ng-disabled="isSelectSubjectAndAudienceSession && !(session.courseId && session.audience)">
        <h2 class="remove-margin">
            <i18n>session</i18n>
            <span class="margin-left-md" ng-show="session.opened">
                <span style="color: green;" ng-if="session.isPublished">(<i18n>published.f</i18n>)</span>
                <span style="color: red;" ng-if="!session.isPublished">(<i18n>draft</i18n>)</span>
            </span>
        </h2>
    </fieldset>

    <div class="row card padding-md" ng-if="session.opened">
        <div class="row">
            <!-- Title -->
            <label class="four cell twelve-mobile">
                <div class="twelve">
                    <i18n>title</i18n>
                </div>
                <input type="text" placeholder="[[placeholder]]" class="twelve twelve-mobile" maxlength="50" ng-model="session.title"/>
            </label>
            <div class="one"></div>
            <!-- Room -->
            <label class="two cell horizontal-spacing twelve-mobile">
                <div class="twelve">
                    <i18n>utils.room</i18n>
                </div>
                <input type="text" class="twelve twelve-mobile" maxlength="50" ng-model="session.room"/>
            </label>
            <div class="one"></div>
            <!-- Type -->
            <label class="two cell horizontal-spacing twelve-mobile">
                <div class="twelve">
                    <i18n>homework.manage.type</i18n>
                    *
                </div>
                <div class="cell twelve-mobile ten">
                    <select class="formSessionType" required ng-model="session.type"
                            ng-change="changeSelect(session.type)"
                            ng-options="sessionType.label for sessionType in sessionTypes.all track by sessionType.id">
                    </select>
                </div>
            </label>
            <div class="one"></div>
            <!-- Date -->
            <div class="three cell horizontal-spacing twelve-mobile">
                <label class="row twelve vertical-spacing">
                    <div class="twelve margin-bottom-md">
                        <i18n>date</i18n>
                        *
                    </div>
                </label>

                <div class="twelve twelve-mobile">
                    <span class="twelve-mobile">
                        <i18n ng-if="!(session.courseId && session.date)">the</i18n>
                        <label ng-model="session.date" ng-if="session.courseId && session.date">
                            [[transformDateToFrenchDate(session.date) | date:'EEEE dd MMMM yyyy']]
                        </label>
                        <date-picker class="date-picker-sm" ng-if="!(session.courseId && session.date)"
                                     ng-model="session.date">
                        </date-picker>
                    </span>
                    <i18n>from2</i18n>
                    <label ng-model="session.startTime" class="margin-left-sm margin-right-sm"
                           ng-if="session.courseId && session.startTime">
                        [[session.startTime | date:'HH:mm']]
                    </label>
                    <input type="time"
                           class="margin-left-sm margin-right-sm"
                           ng-if="!(session.courseId && session.startTime)"
                           ng-model="session.startTime"/>
                    <i18n>to2</i18n>
                    <label ng-model="session.endTime" class="margin-left-sm margin-right-sm"
                           ng-if="session.courseId && session.endTime">
                        [[session.endTime | date:'HH:mm']]
                    </label>
                    <input type="time"
                           class="margin-left-sm margin-right-sm"
                           ng-if="!(session.courseId && session.endTime)"
                           ng-model="session.endTime"/>
                </div>
            </div>

            <!-- Publish -->
            <label class="one cell horizontal-spacing twelve-mobile">
                <div class="twelve margin-bottom-md">
                    <i18n>utils.publish</i18n>
                </div>
                <switch class="vertical-spacing" ng-model="session.isPublished">
                    <label class="switch"> </label>
                </switch>
            </label>
            <div class="one"></div>
        </div>

        <!-- Warning date -->
        <div ng-if="!validDate()" class="warning ">
            <i18n>diary.error.date.is.not.valid</i18n>
        </div>

        <!-- Description -->
        <div class="row">
            <div class="row twelve vertical-spacing">
                <span class="twelve margin-20">
                    <i18n>utils.description</i18n>
                </span>
            </div>
            <editor ng-model="session.description"></editor>
        </div>

        <div ng-if="session.homeworks.length < 1" class="padding-md margin-bottom-md">
            <button ng-show="!validate"
                    class="float-none display-inline-block margin-top-md"
                    ng-click="addHomework()">
                <i18n>homework.manage.create</i18n>
            </button>
        </div>

        <div ng-if="session.homeworks.length" class="margin-bottom-md">
            <h2 ng-if="session.homeworks.length && hasOneHomeworkInList()">
                <i18n>homeworks</i18n>
            </h2>
            <div class="responsive-table row" ng-show="session.homeworks.length && hasOneHomeworkInList()">
                <table class="twelve">
                    <thead>
                    <tr>
                        <td class="two text-left padding-left-md">
                            <i18n>deadline</i18n>
                        </td>
                        <td class="one text-left">
                            <i18n>homework.manage.type</i18n>
                        </td>
                        <td class="eight text-left">
                            <i18n>settings.exclusion.description</i18n>
                        </td>
                        <td class="one">&nbsp;</td>
                    </tr>
                    </thead>

                    <tbody>
                    <tr ng-repeat="homework in session.homeworks track by $index" ng-if="!homework.isDeleted"
                        inside-session-form="true"
                        ng-controller="manageHomeworkCtrl">
                        <!-- Deadline static data -->
                        <td ng-if="!homework.opened" class="three vertical-align-top text-left">
                            <p ng-if="homework.attachedToDate" class="margin-bottom-md twelve"> [[homework.dateDisplayed]]</p>
                            <p ng-if="homework.attachedToSession && !homework.session.firstText" class="margin-bottom-md twelve">
                                <i18n>homework.attachedToSession</i18n>
                                [[homework.session.startDisplayDate]]
                                [[homework.session.startDisplayTime]] [[homework.session.endDisplayTime]]
                                [[homework.session.subject.label]]
                            </p>

                            <p ng-if="homework.attachedToSession && homework.session.firstText" class="margin-bottom-md twelve">
                                <i18n>todo.for.this.session</i18n>
                            </p>
                        </td>

                        <!-- Type static data -->
                        <td ng-if="!homework.opened" class="two vertical-align-top text-left ">
                            <p class="twelve">[[homework.type.label]]</p>
                        </td>

                        <!-- Description -->
                        <td ng-if="!homework.opened" class="five vertical-align-top full-td-width text-left">
                            <p class="twelve" bind-html="[[homework.description]]"></p>
                        </td>
                        <!-- Button part -->
                        <td ng-if="!homework.opened">
                            <i ng-show="!homework.opened && !hidePencil" ng-click="$parent.openHomework(homework)">&#xe858;</i>
                            <i ng-show="!homework.opened" class="trash right-magnet" ng-click="deleteHomework($index);$parent.cancelValidateOnDelete(homework,$index);"></i>
                        </td>
                    </tr>
                    </tbody>
                </table>

            </div>

            <div class="row">

                <div ng-repeat="homework in session.homeworks track by $index" ng-show="!homework.isDeleted"
                     inside-session-form="true"
                     ng-controller="manageHomeworkCtrl">


                    <div ng-if="homework.opened" class="padding-md">
                        <!-- Deadline -->
                        <div ng-if="homework.opened" class="float-left three vertical-align-top text-left">
                            <div class="ten flex twelve-mobile">
                                <label>
                                    <i18n>deadline</i18n>
                                    :
                                </label>

                                <div class="six flex margin-auto space-around margin-bottom-md">
                                    <label><!-- ng-if="sessionsToAttachTo && sessionsToAttachTo.length > 0"-->
                                        <input type="radio"
                                               ng-click="attachToSession()"
                                               ng-checked="homework.attachedToSession"
                                               value="true">
                                        <span class="no-style ng-scope"><i18n>session</i18n></span>
                                    </label><br>
                                    <label>
                                        <input type="radio"
                                               ng-click="attachToDate()"
                                               ng-checked="homework.attachedToDate"
                                               value="false">
                                        <span class="no-style ng-scope"><i18n>date</i18n></span>
                                    </label>
                                </div>
                            </div>
                            <div class="row">
                                <date-picker class="date-picker-sm" ng-if="homework.attachedToDate"
                                             ng-model="homework.dueDate" ng-change="syncWorkloadWeek()"></date-picker>
                                <select class="ten"
                                        ng-if="!homework.attachedToDate"
                                        ng-model="homework.session"
                                        ng-change="syncWorkloadWeek()"
                                        ng-options="session as (session.firstText || session.startDisplayDate + ' ' + session.startDisplayTime
                + '-' + session.endDisplayTime + ' - ' + session.subject.label ) for session in sessionsToAttachTo">
                                </select>

                                <!-- Type -->
                                <select class="ten" ng-if="homework.opened"
                                        required
                                        ng-model="homework.type"
                                        ng-options="homeworkType.label for homeworkType in homeworkTypes.all track by homeworkType.id">
                                </select>
                            </div>

                            <!--Estimated Time-->
                            <div class="margin10v">
                                <span class="ten">
                                    <label>
                                        <i18n>homework.workload</i18n>
                                        <input class="two margin-right-sm margin-left-sm"
                                               ng-model="homework.estimatedTime" min="0" type="number">
                                        <i18n>minutes</i18n>
                                    </label>
                                </span>
                            </div>

                            <!-- Workload -->
                            <div class="margin10v"
                                 ng-if="sessionsToAttachTo ||  homework.attachedToDate">
                                <span ng-if="getNbHomeworkByDay() !== 0" class="ten">
                                    <label>
                                        [[getNbHomeworkByDay()]]
                                    </label>
                                    <i18n>homework(s)</i18n>
                                </span>
                                <span ng-if="getNbHomeworkByDay() === 0" class="ten">
                                    <i18n>diary.empty.homework</i18n>
                                </span>
                            </div>

                            <!-- switch publish -->
                            <div class="flex twelve-mobile">
                                <label class="vertical-spacing margin-right-md">
                                    <i18n>utils.publish</i18n>
                                    :
                                </label>

                                <switch class="vertical-spacing" ng-change="homework.publishedChanged = !homework.publishedChanged" ng-model="homework.isPublished">
                                    <label class="switch"> </label>
                                </switch>
                            </div>

                            <div ng-if="homework.publishDate && homework.isPublished" class="flex twelve-mobile">
                                <label class="vertical-spacing margin-right-md">
                                    <i18n>homework.published.date.teacher</i18n>
                                    [[homework.publishDate]]
                                </label>
                            </div>
                        </div>

                        <!-- Description-->
                        <div ng-if="homework.opened" class="nine float-none display-inline-block vertical-align-top text-left">
                            <div class="twelve-mobile">
                                <label>
                                    <i18n>utils.description</i18n>
                                    :
                                </label>
                            </div>

                            <editor class="twelve" ng-model="homework.description"></editor>
                        </div>
                    </div>
                </div>

                <button ng-show="!validate"
                        class="float-none display-inline-block margin-top-md"
                        ng-click="addHomework()">
                    <i18n>homework.manage.create</i18n>
                </button>
                <button ng-show="validate"
                        class="float-none display-inline-block margin-top-md"
                        ng-disabled="!areValidHomeworks()"
                        ng-click="closeHomework()">
                    <i18n>validate</i18n>
                </button>
                <button type="button"
                        class="cancel float-none display-inline-block"
                        ng-show="formIsOpened"
                        ng-click="cancelHomework()">
                    <i18n>utils.cancel</i18n>
                </button>

            </div>
        </div>

    </div>
</div>
</div>