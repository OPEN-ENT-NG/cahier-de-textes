<div class="session-form">
    <div class="row">
        <div class="six cell twelve-mobile">
            <select required ng-model="session.audience"
                    ng-change="disableFieldSetSubjectAndAudienceSession(session.audience,session.subject)"
                    ng-disabled="session.courseId && session.audience"
                    ng-options="audience.name for audience in structure.audiences.all track by audience.id">
                <option ng-if="structure.audiences.all.length !== 1"  value="" disabled selected>[[translate('select.audience')]]</option>
            </select>
            <select required ng-model="session.subject"
                    ng-change="disableFieldSetSubjectAndAudienceSession(session.audience,session.subject)"
                    ng-disabled="session.courseId && session.subject"
                    ng-options="subject.label for subject in subjects.all track by subject.id">
                <option ng-if="subjects.all.length !== 1" value="" disabled selected>[[translate('select.subject')]]</option>
            </select>
        </div>
    </div>

    <fieldset class="row cursorDefault card remove-margin padding-md border-widht-fieldset"
              ng-disabled="isSelectSubjectAndAudienceSession && !(session.courseId && session.audience)">
        <h2 class="remove-margin">
            <i18n>session</i18n>
            <span class="margin-left-md" ng-show="session.opened">
                <span style="color: green;" ng-if="session.isPublished">(<i18n>published.f</i18n>)</span>
                <span style="color: red;" ng-if="!session.isPublished">(<i18n>draft</i18n>)</span>
            </span>
        </h2>
    </fieldset>

    <div class="row card padding-md" ng-if="session.opened">
        <!-- Title -->
        <label class="two cell twelve-mobile">
            <div class="twelve">
                <i18n>title</i18n>
            </div>
            <input type="text" placeholder="[[placeholder]]" class="twelve twelve-mobile" ng-model="session.title"/>
        </label>
        <div class="one"></div>
        <!-- Room -->
        <label class="two cell horizontal-spacing twelve-mobile">
            <div class="twelve">
                <i18n>utils.room</i18n>
            </div>
            <input type="text" class="twelve twelve-mobile" ng-model="session.room" maxlength="8"/>
        </label>
        <div class="one"></div>
        <!-- Type -->
        <label class="cell horizontal-spacing twelve-mobile">
            <div class="twelve">
                <i18n>homework.manage.type</i18n>
            </div>
            <div class="cell twelve-mobile ten">
                <select class="formSessionType" required ng-model="session.type"
                        ng-change="changeSelect(session.type)"
                        ng-options="sessionType.label for sessionType in sessionTypes.all track by sessionType.id">
                </select>
            </div>
        </label>
        <div class="one"></div>
        <!-- Date -->
        <div class="five cell horizontal-spacing twelve-mobile">
            <label class="row twelve vertical-spacing">
                <div class="twelve">
                    <i18n>date</i18n>
                    *
                </div>
            </label>

            <div class="twelve twelve-mobile">
                <span class="twelve-mobile">
                    <i18n ng-if="!(session.courseId && session.date)">the</i18n>
                    <label ng-model="session.date" ng-if="session.courseId && session.date">
                        [[transformDateToFrenchDate(session.date) | date:'EEEE dd MMMM yyyy']]
                    </label>
                    <date-picker class="date-picker-sm" ng-if="!(session.courseId && session.date)"
                                 ng-model="session.date">
                    </date-picker>
                </span>
                <i18n>from2</i18n>
                <label ng-model="session.startTime" class="margin-left-sm margin-right-sm"
                       ng-if="session.courseId && session.startTime">
                    [[session.startTime | date:'HH:mm']]
                </label>
                <input type="time"
                       class="margin-left-sm margin-right-sm"
                       ng-if="!(session.courseId && session.startTime)"
                       ng-model="session.startTime"/>
                <i18n>to2</i18n>
                <label ng-model="session.endTime" class="margin-left-sm margin-right-sm"
                       ng-if="session.courseId && session.endTime">
                    [[session.endTime | date:'HH:mm']]
                </label>
                <input type="time"
                       class="margin-left-sm margin-right-sm"
                       ng-if="!(session.courseId && session.endTime)"
                       ng-model="session.endTime"/>
            </div>
        </div>

        <!-- Publish -->
        <label class="one cell horizontal-spacing twelve-mobile">
            <div class="twelve margin-bottom-md">
                <i18n>utils.publish</i18n>
            </div>
            <switch class="vertical-spacing" ng-model="session.isPublished">
                <label class="switch"> </label>
            </switch>
        </label>
        <div class="one"></div>

        <!-- Description-->
        <div class="row">
            <div class="row twelve vertical-spacing">
                <span class="twelve margin-20">
                    <i18n>utils.description</i18n>
                </span>
            </div>
            <editor ng-model="session.description"></editor>
        </div>

        <div ng-if="session.homeworks.length < 1" class="padding-md margin-bottom-md">
            <button ng-show="!validate"
                    class="float-none display-inline-block margin-top-md"
                    ng-click="addHomework()">
                <i18n>homework.manage.create</i18n>
            </button>
        </div>

        <div ng-if="session.homeworks.length" class="margin-bottom-md">
            <h2>
                <i18n>homeworks</i18n>
            </h2>
            <div class="responsive-table row" ng-if="session.homeworks.length && !session.homeworks[0].opened && session.homeworks[0].type">

                <table class="twelve">
                    <thead>
                    <tr>
                        <td class="two text-left padding-left-md">
                            <i18n>deadline</i18n>
                        </td>
                        <td class="one text-left">
                            <i18n>homework.manage.type</i18n>
                        </td>
                        <td class="eight text-left">
                            <i18n>settings.exclusion.description</i18n>
                        </td>
                        <td class="one">&nbsp;</td>
                    </tr>
                    </thead>

                    <tbody>
                    <tr ng-repeat="homework in session.homeworks track by $index" ng-if="!homework.isDeleted"
                        inside-session-form="true"
                        ng-controller="manageHomeworkCtrl">
                        <!-- Deadline static data -->
                        <td ng-if="!homework.opened" class="three vertical-align-top text-left">
                            <p ng-if="homework.attachedToDate" class="margin-bottom-md twelve"> [[homework.dateDisplayed]]</p>
                            <p ng-if="homework.attachedToSession && !homework.session.firstText" class="margin-bottom-md twelve">
                                <i18n>homework.attachedToSession</i18n>
                                [[homework.session.startDisplayDate]]
                                [[homework.session.startDisplayTime]] [[homework.session.endDisplayTime]]
                                [[homework.session.subject.label]]
                            </p>

                            <p ng-if="homework.attachedToSession && homework.session.firstText" class="margin-bottom-md twelve">
                                <i18n>todo.for.this.session</i18n>
                            </p>
                        </td>

                        <!-- Type static data -->
                        <td ng-if="!homework.opened" class="two vertical-align-top text-left ">
                            <p class="twelve">[[homework.type.label]]</p>
                        </td>

                        <!-- Description -->
                        <td ng-if="!homework.opened" class="five vertical-align-top full-td-width text-left">
                            <p class="twelve" ng-bind-html="[[homework.description]]"></p>
                        </td>

                        <!-- Button part -->
                        <td ng-if="!homework.opened">
                            <i ng-show="!homework.opened && $parent.areValidHomeworks()" ng-click="$parent.openHomework(homework)">&#xe858;</i>
                            <i ng-show="!homework.opened" class="trash right-magnet" ng-click="deleteHomework($index);$parent.cancelValidateOnDelete(homework,$index);"></i>
                        </td>
                    </tr>
                    </tbody>
                </table>

            </div>

            <div class="row">

                <div ng-repeat="homework in session.homeworks track by $index" ng-show="!homework.isDeleted"
                     inside-session-form="true"
                     ng-controller="manageHomeworkCtrl">
                    <container template="formHomework"></container>
                </div>

                <button ng-show="!validate"
                        class="float-none display-inline-block margin-top-md"
                        ng-click="addHomework()">
                    <i18n>homework.manage.create</i18n>
                </button>
                <button ng-show="validate"
                        class="float-none display-inline-block margin-top-md"
                        ng-disabled="!areValidHomeworks()"
                        ng-click="closeHomework()">
                    <i18n>validate</i18n>
                </button>
                <button type="button"
                        class="cancel float-none display-inline-block"
                        ng-show="formIsOpened"
                        ng-click="cancelHomework()">
                    <i18n>utils.cancel</i18n>
                </button>

            </div>
        </div>

        <div ng-if="!validDate()" class="warning ">
            <i18n>diary.error.date.is.not.valid</i18n>
        </div>
    </div>
</div>
</div>